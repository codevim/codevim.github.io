<!DOCTYPE html>
<html lang="zhc-cn">
<head>
	<meta name="generator" content="Hugo 0.37" />
    <meta charset="utf-8" />
    <meta viewport="width=device-width, initial-scale=1" />

    
    <title>天外天 My Site</title>
    

    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/code.github.css">
</head>

<body>
    <div class="container">
        <div class="block-container">
            <div id="header" class="header">
    <div class="header-container">
        <div class="brand">
            <h1 class="u-link">
                <a href="/">天外天 My Site</a>
            </h1>
        </div>
        <div class="nav-container">
            <div class="nav">
                
                <div class="u-link nav-item">
                    <a href="/">home</a>
                </div>
                
                <div class="u-link nav-item">
                    <a href="/tags">tags</a>
                </div>
                
                <div class="u-link nav-item">
                    <a href="https://github.com">project</a>
                </div>
                
            </div>
            <div class="clearfix"></div>
        </div>
    </div>
</div>
            
<div class="block-index">
    <div class="posts">
        
        <div class="post">
            <h1 class="post-title u-link">
                <a href="https://codevim.github.io/post/2012/2012-07-14-compiling-linux-kernel/">编译Linux内核</a>
            </h1>
            <div class="post-meta">
    <span class="post-date">2012.7.14</span>
    
        &middot;
        
        <span class="post-tag u-link">
            <a href="/tags/linux">Linux</a>
        </span>
        
        <span class="post-tag u-link">
            <a href="/tags/%E5%86%85%E6%A0%B8">内核</a>
        </span>
        
        <span class="post-tag u-link">
            <a href="/tags/%E7%BC%96%E8%AF%91%E6%BA%90%E7%A0%81">编译源码</a>
        </span>
        
    
</div>
            <div class="post-content">
                

<p>这几天实验室交给任务，编译linux内核。然后就开始做了。</p>

<p>师兄给了两篇参考文章，<a href="http://syshack.blog.51cto.com/304393/144321/">这篇</a>和<a href="http://bbs.chinaunix.net/thread-2264758-1-1.html">这篇</a>。第一篇比较简略，说了总体的过程，而第二篇比较而言就比较详细了。</p>

<p>好了，现在说说自己的编译的过程吧。</p>

<h3 id="一-下载源码并解压">一、下载源码并解压</h3>

<p>源码从<a href="http://kernel.org">这里</a>下载，我下载的是最新的3.5-rc6。具体那个版本都是差不多的。然后需要把源码解压到/usr/src这个目录下，我是ubuntu用户，其他发行版相似</p>
<div class="highlight"><pre class="chroma">sudo cp /path/to/file/linux-3.5-rc6.tar.bz2 /usr/src
sudo tar jxvf linux-3.5-rc6
cd linux-3.5-rc6/  # 进入源码的目录，以后所有操作均在该目录下完成</pre></div>
<h3 id="二-删除之前编译的残留文件">二、删除之前编译的残留文件</h3>
<div class="highlight"><pre class="chroma">sudo make mrproper</pre></div>
<p>如果是第一次编译的话，可以不用执行这一步。而如果之前曾经编译过，务必执行这一步，清除残留文件，否则可能会导致编译失败。</p>

<h3 id="三-配置编译选项">三、配置编译选项</h3>
<div class="highlight"><pre class="chroma">sudo make config
sudo make menuconfig
sudo make xconfig</pre></div>
<p>这三个命令任选一个执行就好了。区别是</p>

<ul>
<li><p>make config<br />
问答式的配置，选错之后无法更改，所以一般人都不会用这个。</p></li>

<li><p>make menuconfig<br />
这个命令需要ncurses库的支持，ncurses是字符界面下的图形界面库。可以通过<code>apt-get install libncurses5-dev</code>来安装。ncurses是字符界面下的图形界面库，所以如果使用的字符控制台，就可以用选用menuconfig了</p></li>

<li><p>make xconfig<br />
这个命令需要Qt，这是个跨平台的图形界面库。可以通过<code>sudo apt-get install libqt...</code>来安装，具体是那个包忘记了。xconfig就是图形界面下的配置环境了。</p></li>
</ul>

<p>xconfig用着最舒服，menugconfig也可以，不过界面难看了些。config自己没用过，也不推荐用。</p>

<p>这一步其实应该是很重要的一步，不过由于选项众多，且众多选项和硬件相关，需要有足够的硬件知识，并且对自己电脑的硬件配置有足够的了解才可能完全配置的好。网上有许多专门讲这一步的文章，比如<a href="http://tmdnet.nothave.com/man/Linux%202_6_19_x%20%E5%86%85%E6%A0%B8%E7%BC%96%E8%AF%91%E9%85%8D%E7%BD%AE%E9%80%89%E9%A1%B9%E7%AE%80%E4%BB%8B.htm">金步国的这篇经典文章</a>，不过由于版本还是2.6，所以有许多选项文章里面没有讲到。</p>

<p>由于本人是个菜鸟，对于硬件以及其他的知识都不是很清楚，再加上这么多的选项，所以大部分都是默认的选项。当然，这样就使得modules过多，使得之后的make modules的时候花费了大量的时间。所以应该尽量的减少不需要的模块，特便是其中的许多针对不同的硬件的驱动。</p>

<h3 id="四-编译内核">四、编译内核</h3>
<div class="highlight"><pre class="chroma">sudo make bzImage</pre></div>
<p>在我参考的第二篇文章中说，他编译出来的内核大约在800k-900k左右，可是实际上我编译出来的内核一般在4500k左右。可能是由于版本的差异吧，不用纠结在这个上面。</p>

<p>在编译结束后，会告诉你bzImage的位置，然后执行</p>
<div class="highlight"><pre class="chroma">sudo cp /path/to/bzImage /boot/vmlinuz-3.5-rc6</pre></div>
<p>把其放到/boot目录下。这里我把它重命名为vmlinuz-3.5-rc6？为什么是这个名字？自己看看/boot，更深层原因我也不知道了。</p>

<h3 id="五-编译模块">五、编译模块</h3>
<div class="highlight"><pre class="chroma">sudo make modules</pre></div>
<p>上边也说了，这个阶段的时间是和配置选项那一步中选择的模块的多少直接相关的。有时可能会遇到rts5139.ko undefined的错误，可以在配置选项时去掉rts5139这个模块。</p>

<h3 id="六-安装模块">六、安装模块</h3>
<div class="highlight"><pre class="chroma">sudo make modules_install</pre></div>
<p>这一步没什么说的。有时可能会出错，并让你make CONFIG_MISMATCH=y(这个选项记不清了，不过差不多了)，可以不用理。</p>

<h3 id="七-安装内核">七、安装内核</h3>
<div class="highlight"><pre class="chroma">sudo make install</pre></div>
<p>这一步比较快。在这一步，系统会自动更新grub。</p>

<p>如果以上完全弄好了，那么就可以重启进入新的内核体验了。不过有的同学在重启后可能会遇到这样一个问题，就是无法进入图形界面了。
提示类似如&rdquo;ubuntu run in a low-graphic mode&rdquo;,&ldquo;Your screen, graphic card, input devices cannot detected correctly. You need configure it yourself.&ldquo;等等。
这时可以Ctrl-Alt-F1或者Alt-F1进入控制台，<code>sudo apt-get install gdm</code>之后选择gdm即可。如果还不能解决问题，对于ATI显卡，可以安装fglrx。由于我不是ATI的显卡，所以是否可行我就不是很清楚了。更具体的可以google之。</p>

            </div>
        </div>
        
        <div class="post">
            <h1 class="post-title u-link">
                <a href="https://codevim.github.io/post/2012/2012-06-20-logic-operation-in-python/">Python的逻辑运算</a>
            </h1>
            <div class="post-meta">
    <span class="post-date">2012.6.20</span>
    
        &middot;
        
        <span class="post-tag u-link">
            <a href="/tags/python">Python</a>
        </span>
        
        <span class="post-tag u-link">
            <a href="/tags/%E8%AF%AD%E4%B9%89">语义</a>
        </span>
        
    
</div>
            <div class="post-content">
                <p>Python的逻辑运算(and，or，not)与C/C++、Java等语言不太一样。这些语言的逻辑运算返回的值都是bool值，而Python返回的则不同。</p>

<p>先说非运算，Python的非运算与这些语言相比，并没有特别的地方。not只有两个返回值，True和False。在Python中，真值为假的对象，包括False，None，数字0，空字符串以及空的容器类型。除此以外的任何对象均为真。</p>

<p>接下来是与运算，Python的与运算的规则是</p>

<ul>
<li>若左边的表达式为真，则返回右边表达式的值</li>
<li>否则，返回左边表达式的值</li>
</ul>

<p>初看起来比较奇怪，一个逻辑运算搞得这么复杂干嘛？这么做当然是有目的的。当我们需要的不是一个表达式的bool值而事实其表达式的值，但是只是需要根据这个表达式的bool值确定下一步的动作，就会发现这种规定的好处了。</p>

<p>比如需要统计一下重量在500克以上的桃子的重量，用C写，可能会写成这样</p>
<div class="highlight"><pre class="chroma">for (i = 0; i &lt; n; ++i) {
    if (weights[i] &gt; 500)
        sumofweight += weights[i];
}</pre></div>
<p>用Python，就可以这样写</p>
<div class="highlight"><pre class="chroma">for x in weights:
    sumofweights += x &gt; 500 and x</pre></div>
<p>显然是简单了许多。</p>

<p>最后再来说或运算，Python的或运算的规则是</p>

<ul>
<li>若左边的表达式为真，则返回左边的表达式的值</li>
<li>否则，返回右边的表达式的值</li>
</ul>

<p>这个规定和或运算的目同出一辙，都是为了简化代码，增加效率。</p>

<p>可能有些同学觉得and和or的规则比较复杂，不容易记忆。其实，这是不需要记忆的，因为，<strong>无论是and还是or，其结果的值就是最终决定整个表达式真值的表达式的值</strong>。</p>

<p>对于与运算</p>
<div class="highlight"><pre class="chroma">a and b</pre></div>
<ul>
<li>如果a为真，继续计算b，b将决定最终整个表达式的真值，所以，结果为b的值</li>
<li>如果a为假，无需计算b，就可以得知整个表达式的真值为假，所以，结果为a的值</li>
</ul>

<p>对于或运算</p>
<div class="highlight"><pre class="chroma">a or b</pre></div>
<ul>
<li>如果a为真，无需计算b，就可得知整个表达式的真值为真，所以结果为a的值</li>
<li>如果a为假，继续计算b，b将决定整个表达式最终的值，所以结果为b的值</li>
</ul>

<p>最后再说一下and or表达式，通常所说的and or表达式是指如下的表达式</p>
<div class="highlight"><pre class="chroma">condition and a or b</pre></div>
<p>这个表达式和C中的唯一一个三目运算符</p>
<div class="highlight"><pre class="chroma">condition ? a : b</pre></div>
<p>比较相似，但稍有不同。C中三目表达式的语义如下</p>
<div class="highlight"><pre class="chroma">if condition:
    a
else:
    b</pre></div>
<p>但是Python的and or则不同，由于Python的逻辑表达式的运算规则，必须保证a的真值为真，才和C的三目运算符相同，而若a为假，不论condition的真值为何，总会选择b而非a。</p>

<p>可以说，Python的逻辑运算给程序员带来了极大的编程快捷，但是若不能理解其如此设计的原因，就不能自如的运用其便捷性，甚至造成错误而不知。</p>

            </div>
        </div>
        
    </div>
    

<ul class="pagination">
    
    <li>
        <a href="/" aria-label="First"><span aria-hidden="true">&laquo;&laquo;</span></a>
    </li>
    
    <li
    >
    <a href="/page/6/" aria-label="Previous"><span aria-hidden="true">&laquo;</span></a>
    </li>
    
    
    
    
    
    
        
        
    
    
    <li
    ><a href="/">1</a></li>
    
    
    
    
    
    
        
        
    
    
    <li
    ><a href="/page/2/">2</a></li>
    
    
    
    
    
    
        
        
    
    
    <li
    ><a href="/page/3/">3</a></li>
    
    
    
    
    
    
        
        
    
    
    <li class="disabled"><span aria-hidden="true">&hellip;</span></li>
    
    
    
    
    
    
        
        
    
    
    
    
    
    
    
        
        
    
    
    <li
    ><a href="/page/6/">6</a></li>
    
    
    
    
    
    
        
        
    
    
    <li
    class="active"><a href="/page/7/">7</a></li>
    
    
    <li
    class="disabled">
    <a href="" aria-label="Next"><span aria-hidden="true">&raquo;</span></a>
    </li>
    
    <li>
        <a href="/page/7/" aria-label="Last"><span aria-hidden="true">&raquo;&raquo;</span></a>
    </li>
    
</ul>

</div>

            <div id="footer">
    <div class="footer-container">
        <div class="powered-by">Powered by Hugo</div>
        <div class="theme">theme - ink</div>
    </div>
</div>
        </div>
    </div>
</body>
</html>